"use strict";Zepto(function(d){FastClick.attach(document.body);var u="app";window.getAppInfo||(u="browser"),utils.isWeixinBrowser;var p=utils.getParameterByName("accountId"),h={articlelist:"https://shiziquan.com/shiziquan/learn?action=articlelist&accountId=1000036&artId=136",getitemdetail:"https://shiziquan.com/shiziquan/learn?action=getitemdetail",urlpidformat:"https://shiziquan.com/shiziquan/learn?action=urlpidformat"};function m(t,i){d(".modal-content .password").text(t),d(".modal-content .tip").attr("data-clipboard-text",t),d(".modal-content .url").attr("data-clipboard-text",i),utils.copy(".modal-content .tip"),utils.copy(".modal-content .url"),v()}function f(t){if("browser"===u){var i=t.data("commodityid");d.ajax({url:h.getitemdetail,type:"POST",data:{accountId:p,num_iid:i},dataType:"json",success:function(t){var i=t.data;if(!utils.isEmptyObject(i)){var a=i.tbkItemInfo;m(a.tpwd,a.coupon_click_url)}},error:function(){alert("服务器繁忙!")}})}}function v(){d(".dialog-modal").show()}function b(t){d(".action-sheet-modal").show(),d(".action-sheet").addClass("up"),t.stopPropagation()}d(".loading").show(),d.ajax({type:"GET",url:h.articlelist,dataType:"json",success:function(t){d(".wrapper").show(),d(".loading").hide();var i,a,n,e,o,c,r,s=t.data;if(utils.isEmptyObject(s))alert("文章不存在,请刷新重试");else{var l=s.items;l&&l.length&&(a=l[0],n=a.createTime,e=a.title,o=a.desc_title,c=a.pict_url,r=a.artSource,d(".label").text(r),d(".content-source .date").text(n),d(".header-bg").attr("src",c),d(".content-title span").text(e),d(".content-desc p").text(o),i=l[0].content,d(".rich-text-editor").html(i),d(".commodityCard").click(function(){f(d(this))}),function(t){var i=[],a=t.length;if(a){for(var n=0;n<=t.length;n++){var e=t[n];if(e){var o='\n            <li>\n              <a class="relatedGoods" data-commodityid="'+e.num_iid+'">\n                <div class="left"><img src="'+e.pict_url+'"></div>\n                <div class="right">\n                  <div class="product-title">'+e.title+'</div>\n                  <div class="bottom">\n                    <div class="price">￥29.8</div>\n                    <div class="btn">去购买</div>\n                  </div>\n                </div>\n              </a>\n            </li>\n            ';i.push(o)}}d(".related-goods").append(i.join("")),1<a&&function(t){for(var i=[],a=0;a<t.length;a++){var n=t[a],e='\n        <li>\n          <p class="title">'+n.title+'</p>\n          <a class="btn" href="javascript:;" data-commodityid="'+n.num_iid+'">直达链接</a>\n        </li>\n        ';i.push(e)}d(".action-sheet--list").append(i.join("")),d(".action-sheet--list li .btn").click(function(t){var i;f(d(this)),i=t,d(".action-sheet-modal").hide(),d(".action-sheet").removeClass("up"),i.stopPropagation()})}(t),d(".relatedGoods").click(function(){f(d(this))});var c="";c="browser"===u?'\n          <a href="javascript:void(0)" class="through-link">直达链接</a>\n          <a href="javascript:void(0)" class="rebate">返利模式购买</a>\n          ':'<a href="javascript:void(0)" class="through-link">直达链接</a>',d(".bottom-btns-container .btns").append(c);var r=d(".through-link");if("browser"===u){var s=d(".rebate");1<a?(r.click(function(t){b(t)}),s.click(function(){window.location=""})):1===a&&(r.click(function(t){v()}),s.click(function(){window.location=""}))}else 1<a?r.click(function(t){b(t)}):1===a&&r.click(function(t){})}else d(".related-products").hide(),"browser"===u&&(d(".bottom-btns-container .btns").append('<a href="javascript:void(0)" class="view-more-detail">打开APP看更多爆料文章</a>'),d(".activity-desc").css("marginBottom",".8rem"))}(l[0].numInfos),d("a").each(function(t,i){var a=i.href;(-1<a.indexOf("taobao")||-1<a.indexOf("tmall"))&&i.addEventListener("click",function(t){(t=t||window.event).preventDefault?t.preventDefault():t.returnValue=!1,d.ajax({url:h.urlpidformat,type:"POST",data:{accountId:p,linkUrl:a},dataType:"json",success:function(t){var i=t.data;if(!utils.isEmptyObject(i)){var a=i.linkUrl,n=i.tpwd;m(n,a)}},error:function(){alert("服务器繁忙!")}})})}))}},error:function(t,i){alert("服务器繁忙!"),d(".loading").hide()}}),d(".modal-content--btn").click(function(){d(".dialog-modal").hide()}),d(".action-sheet").click(function(t){t.stopPropagation()}),d(document).click(function(){d(".action-sheet-modal").hide(),d(".action-sheet").removeClass("up")})});